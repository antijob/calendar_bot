
# Бот для уведомлений о событиях Google Календаря в Telegram

Этот проект представляет собой Python-бота, который интегрируется с Google Календарем и Telegram. Бот отправляет уведомления в указанную Telegram-группу о событиях, которые произойдут **за 1 день** и **за 1 неделю** до их начала.

## Функционал

- Получает предстоящие события из Google Календаря.
- Фильтрует события и отправляет уведомления за 1 день и за 7 дней до начала события.
- Отправляет уведомления в указанную Telegram-группу.
- Автоматически загружает конфиденциальную информацию (API-ключи, токены и т.д.) из файла `.env`.

## Требования

1. Установленный **Python 3.x**.
2. **Google Calendar API Key** и доступ к календарю, который вы хотите отслеживать.
3. **Telegram бот**, созданный через [BotFather](https://t.me/BotFather).
4. **ID группы Telegram**, в которую будут отправляться уведомления (можно получить через API Telegram методом `getUpdates` после добавления бота в группу).

## Начало работы

### 1. Клонируйте репозиторий
```bash
git clone https://github.com/your-username/telegram-calendar-bot.git
cd telegram-calendar-bot
```

### 2. Настройте окружение

Создайте виртуальное окружение и активируйте его (необязательно, но рекомендуется):
```bash
python3 -m venv venv
source venv/bin/activate  # Для Windows: venv\Scripts\activate
```

Установите необходимые зависимости:
```bash
pip install -r requirements.txt
```

### 3. Настройте Google Calendar API

Для использования Google Calendar API выполните следующие шаги:

1. Перейдите в [Google Cloud Console](https://console.cloud.google.com/).
2. Создайте новый проект и включите **Google Calendar API**.
3. Создайте учетные данные API:
   - Перейдите в **APIs & Services** > **Credentials** > **Create Credentials**.
   - Выберите **API Key** и скопируйте ключ.
4. Настройте **ID календаря**:
   - Откройте Google Календарь, найдите нужный календарь.
   - Перейдите в **Настройки и доступ** и прокрутите до **Интеграция календаря**, скопируйте **ID календаря**.

### 4. Настройте Telegram-бота

1. Откройте Telegram и найдите [BotFather](https://t.me/BotFather).
2. Создайте нового бота и получите **API токен**.
3. Добавьте вашего бота в Telegram-группу, в которую хотите получать уведомления.
4. Получите **ID группы** с помощью метода API Telegram:
   ```
   https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates
   ```
   Найдите `id` группы в ответе.

### 5. Настройте файл `.env`

Создайте файл `.env` в корневой директории проекта и добавьте туда:

```
GOOGLE_API_KEY=your-google-api-key-here
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here
TELEGRAM_GROUP_ID=-1001234567890  # Замените на ID вашей группы
CALENDAR_ID=your-calendar-id-here
```

### 6. Запустите бота

После настройки всего необходимого запустите бота с помощью:

```bash
python calendar_bot.py
```

Бот выполнит следующие шаги:
1. Получит события из указанного Google Календаря.
2. Отфильтрует события, которые начнутся через 1 день и через 7 дней.
3. Отправит уведомления в Telegram-группу, если такие события найдены.

## Настройка

- **Изменение периода уведомлений**: Если вы хотите изменить период уведомлений (например, за 2 дня), обновите значения `timedelta(days=1)` и `timedelta(days=7)` в функции `filter_events()`.

- **Настройка формата сообщений**: Вы можете изменить формат текста уведомлений в функции `send_telegram_message()`.

## Пример вывода

- Для события, которое произойдет через 1 день:
  ```
  Событие через 1 день: Встреча команды
  Начало: 2024-10-03T09:00:00+03:00
  ```

- Для события, которое произойдет через 1 неделю:
  ```
  Событие через 1 неделю: Дедлайн проекта
  Начало: 2024-10-10T17:00:00+03:00
  ```

## Зависимости

- **google-api-python-client**: Для взаимодействия с Google Calendar API.
- **python-dotenv**: Для загрузки переменных окружения из файла `.env`.
- **requests**: Для отправки HTTP-запросов к API Telegram.

### Установка зависимостей через `requirements.txt`:

```bash
google-api-python-client
python-dotenv
requests
```

## Устранение неполадок

- **Ошибка HTTP 400 при отправке сообщения в Telegram**: Проверьте правильность значений `TELEGRAM_BOT_TOKEN` и `TELEGRAM_GROUP_ID` в файле `.env`.
- **События не загружаются**: Убедитесь, что ваш `CALENDAR_ID` и API ключ корректны, и у вас есть доступ к календарю.

## Лицензия

Этот проект является открытым и распространяется под лицензией Apache-2.0.

---

Этот бот поможет вам оставаться в курсе предстоящих событий Google Календаря, отправляя уведомления прямо в вашу Telegram-группу. Вы можете настроить его в соответствии с вашими потребностями!